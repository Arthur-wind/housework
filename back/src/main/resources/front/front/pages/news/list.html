<!DOCTYPE html>
<html>
<head lang="en">
	<meta charset="utf-8">
	<title>网站公告</title>
	<meta name="keywords" content="" />
	<meta name="description" content="" />
	<meta name="renderer" content="webkit">
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
	<link rel="stylesheet" href="../../layui/css/layui.css">
	<link rel="stylesheet" href="../../xznstatic/css/common.css"/>
	<link rel="stylesheet" href="../../xznstatic/css/style.css"/>
	<script type="text/javascript" src="../../xznstatic/js/jquery-1.11.3.min.js"></script>
	<script type="text/javascript" src="../../xznstatic/js/jquery.SuperSlide.2.1.1.js"></script>
</head>
<style>
	/* 家政主题样式 */
	body {
		background-image: url('https://img.freepik.com/free-photo/clean-white-towel-bathroom_53876-133328.jpg');
		background-size: cover;
		background-attachment: fixed;
		background-position: center;
		font-family: 'Microsoft YaHei', sans-serif;
	}
	.recommend {
		background-color: rgba(255, 255, 255, 0.92);
		border-radius: 12px;
		margin: 30px auto;
		max-width: 1000px;
		box-shadow: 0 5px 20px rgba(0, 0, 0, 0.08);
		padding: 25px;
	}
	.title {
		text-align: center;
		margin-bottom: 30px;
	}
	.title span {
		font-size: 26px;
		color: #5a8f7b;
		font-weight: bold;
		position: relative;
		padding-bottom: 10px;
	}
	.title span:after {
		content: '';
		position: absolute;
		bottom: 0;
		left: 50%;
		transform: translateX(-50%);
		width: 80px;
		height: 3px;
		background: #5a8f7b;
	}

	/* 两行两列布局 */
	.news-grid {
		display: grid;
		grid-template-columns: repeat(2, 1fr);
		gap: 20px;
		margin-bottom: 30px;
		min-height: 500px; /* 保持网格高度一致 */
	}
	.news-item {
		background: #fff;
		border-radius: 10px;
		padding: 20px;
		box-shadow: 0 3px 10px rgba(0,0,0,0.05);
		transition: all 0.3s ease;
		border-left: 4px solid #5a8f7b;
		height: 220px; /* 固定卡片高度 */
	}
	.news-item.empty {
		background: rgba(255,255,255,0.5);
		border: 1px dashed #ddd;
		display: flex;
		align-items: center;
		justify-content: center;
		color: #999;
	}
	.news-item:hover:not(.empty) {
		transform: translateY(-5px);
		box-shadow: 0 8px 20px rgba(0,0,0,0.1);
	}
	.news-title {
		font-size: 18px;
		font-weight: bold;
		color: #5a8f7b;
		margin-bottom: 10px;
		padding-bottom: 10px;
		border-bottom: 1px dashed #e0e0e0;
	}
	.news-date {
		font-size: 13px;
		color: #888;
		margin-bottom: 15px;
	}
	.news-content {
		color: #555;
		line-height: 1.6;
		font-size: 14px;
		display: -webkit-box;
		-webkit-line-clamp: 4;
		-webkit-box-orient: vertical;
		overflow: hidden;
		text-overflow: ellipsis;
	}
	.news-tag {
		display: inline-block;
		background: #5a8f7b;
		color: white;
		padding: 3px 12px;
		border-radius: 15px;
		font-size: 12px;
		margin-top: 15px;
	}

	/* 搜索框样式 */
	.filter {
		background-color: rgba(90, 143, 123, 0.85);
		padding: 15px 20px;
		border-radius: 8px;
		margin: 25px 0;
		display: flex;
		align-items: center;
		justify-content: center;
	}
	.filter .item-list {
		display: flex;
		align-items: center;
		margin-right: 15px;
	}
	.filter .lable {
		color: white;
		font-size: 15px;
		margin-right: 10px;
	}
	.filter input {
		border: 1px solid #ddd;
		border-radius: 6px;
		padding: 8px 15px;
		width: 200px;
	}
	#btn-search {
		background: white;
		color: #5a8f7b;
		border: 1px solid #5a8f7b;
		border-radius: 6px;
		padding: 8px 20px;
		cursor: pointer;
		transition: all 0.3s;
		display: flex;
		align-items: center;
		justify-content: center;
		min-width: 80px;
	}
	#btn-search i {
		margin-right: 5px;
	}
	#btn-search:hover {
		background: #5a8f7b;
		color: white;
	}

	/* 分页样式 */
	.pager {
		margin-top: 30px;
		text-align: center;
	}
	.layui-laypage a, .layui-laypage span {
		color: #5a8f7b;
	}
	.layui-laypage .layui-laypage-curr .layui-laypage-em {
		background-color: #5a8f7b;
	}
</style>
<body>
<div id="app">
	<div class="recommend index-pv2">
		<div class="box">
			<div class="title">
				<span>网站公告</span>
			</div>
			<form class="layui-form filter">
				<div class="item-list">
					<div class="lable">标题</div>
					<input type="text" name="title" id="title" placeholder="请输入标题关键词" autocomplete="off" class="layui-input">
				</div>
				<button id="btn-search" type="button" class="layui-btn layui-btn-normal">
					<i class="layui-icon layui-icon-search"></i>搜索
				</button>
			</form>

			<!-- 两行两列新闻网格 -->
			<div class="news-grid">
				<template v-for="(item,index) in displayList">
					<div v-if="item" class="news-item" @click="jump('../news/detail.html?id='+item.id)">
						<div class="news-title">{{item.title}}</div>
						<div class="news-date">{{item.addtime}}</div>
						<div class="news-content">{{item.introduction}}</div>
						<div class="news-tag">新闻动态</div>
					</div>
					<div v-else class="news-item empty">
						暂无更多公告
					</div>
				</template>
			</div>

			<div class="pager" id="pager"></div>
		</div>
	</div>
</div>

<script src="../../layui/layui.js"></script>
<script src="../../js/vue.js"></script>
<script src="../../js/config.js"></script>
<script src="../../modules/config.js"></script>
<script src="../../js/utils.js"></script>

<script type="text/javascript">
	var vue = new Vue({
		el: '#app',
		data: {
			swiperList: [],
			dataList: [],
			displayList: [], // 用于显示的列表，固定4个元素
			baseurl:''
		},
		computed: {
			// 确保总是返回4个元素的数组，不足部分用null填充
			paddedList() {
				let padded = [...this.dataList];
				while(padded.length < 4) {
					padded.push(null);
				}
				return padded.slice(0, 4);
			}
		},
		watch: {
			dataList: {
				handler(newVal) {
					this.displayList = this.paddedList;
				},
				immediate: true
			}
		},
		filters: {
			newsDesc: function(val) {
				if (val) {
					if (val.length > 60) {
						return val.substring(0, 60).replace(/<[^>]*>/g).replace(/undefined/g, '');
					} else {
						return val.replace(/<[^>]*>/g).replace(/undefined/g, '');
					}
				}
				return '';
			}
		},
		methods: {
			jump(url) {
				jump(url)
			}
		}
	});

	layui.use(['layer', 'element', 'carousel', 'laypage', 'http', 'jquery'], function() {
		var layer = layui.layer;
		var element = layui.element;
		var carousel = layui.carousel;
		var laypage = layui.laypage;
		var http = layui.http;
		var jquery = layui.jquery;

		vue.baseurl = http.baseurl;
		var limit = 4; // 每页显示4条

		// 分页列表
		pageList();

		// 搜索按钮
		jquery('#btn-search').click(function(e) {
			pageList();
		});
		function pageList() {
			// 获取列表数据
			http.request('news/list', 'get', {
				page: 1,
				limit: limit,
				sort: 'addtime',
				order: 'desc',
				title: '%' + jquery('#title').val() + '%',
			}, function(res) {
				vue.dataList = res.data.list;
				// 分页
				laypage.render({
					elem: 'pager',
					count: res.data.total,
					limit: limit,
					groups: 5,
					layout: ["prev","page","next"],
					theme: '#5a8f7b',
					jump: function(obj, first) {
						//首次不执行
						if (!first) {
							http.request('news/list', 'get', {
								page: obj.curr,
								limit: obj.limit
							}, function(res) {
								vue.dataList = res.data.list;
							})
						}
					}
				});
			});
		}
	});
</script>
</body>
</html>